{% extends "coresite/base.html" %}
{% load jsonld seo_tags %}

{% block meta %}
  {% with meta_description=post.excerpt|default:'A blog post on Technofatty.' og_type='article' %}
    {% include "coresite/partials/seo/meta_head.html" %}
  {% endwith %}
  {% if post.date %}<meta property="article:published_time" content="{{ post.date|date:'c' }}">{% endif %}
  {% if post.updated %}<meta property="article:modified_time" content="{{ post.updated|date:'c' }}">{% endif %}
{% endblock %}

{% block structured_data %}
  {{ block.super }}
  {% canonical_url canonical_url as resolved_canonical %}
  {% jsonld %}
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "BlogPosting",
      "@id": "{{ resolved_canonical }}#article",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ resolved_canonical }}#webpage"
      },
      "headline": "{{ post.title|escapejs }}",
      "url": "{{ resolved_canonical }}",
      "datePublished": "{{ post.date|date:'c' }}",
      "dateModified": "{{ post.updated|default:post.date|date:'c' }}",
      "author": {
        "@type": "Organization",
        "@id": "https://technofatty.com/#organization",
        "name": "Technofatty",
        "url": "https://technofatty.com/"
      },
      "publisher": {
        "@type": "Organization",
        "@id": "https://technofatty.com/#organization",
        "name": "Technofatty",
        "url": "https://technofatty.com/"
      },
      "description": "{{ post.excerpt|default:'A blog post on Technofatty.'|escapejs }}",
      "inLanguage": "en"
    },
    {
      "@type": "BreadcrumbList",
      "@id": "{{ resolved_canonical }}#breadcrumb",
      "itemListElement": [
        {"@type": "ListItem", "position": 1, "name": "Home", "item": "https://technofatty.com/"},
        {"@type": "ListItem", "position": 2, "name": "Blog", "item": "https://technofatty.com/blog/"},
        {"@type": "ListItem", "position": 3, "name": "{{ post.title|escapejs }}", "item": "{{ resolved_canonical }}"}
      ]
    }
  ]
}
  {% endjsonld %}
{% endblock %}

{% block content %}
  <section class="section section--scaffold" aria-labelledby="{{ page_id }}-heading">
    <div class="wrap">
        <div class="scaffold__body">
          {% include "coresite/partials/global/status_placeholder.html" %}
          <p class="back-link">← Back to Blog</p>
          <h1 id="{{ page_id }}-heading">{{ page_title }}</h1>
          <p class="post-meta">
            <time datetime="{{ post.date|date:'Y-m-d' }}">{{ post.date|date:'d M Y' }}</time> ·
            <a href="{% url 'blog_category' post.category.slug %}">{{ post.category.title }}</a> ·
            {% for tag in post.tags %}<a href="{% url 'blog_tag' tag.slug %}">#{{ tag.title }}</a>{% if not forloop.last %} {% endif %}{% endfor %}
          </p>
          <nav class="post-outline" aria-label="In this post"></nav>
          <article class="post-body"></article>
          <p class="post-taxonomy">Filed under <a href="{% url 'blog_category' post.category.slug %}">{{ post.category.title }}</a> · {% for tag in post.tags %}<a href="{% url 'blog_tag' tag.slug %}">#{{ tag.title }}</a>{% if not forloop.last %} {% endif %}{% endfor %}</p>
        </div>
      </div>
    </section>
  {% endblock %}
