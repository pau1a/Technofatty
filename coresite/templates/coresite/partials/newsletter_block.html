<!-- TODO: Stakeholder decision: headline_scope (music) -->
<section id="signup"
         class="newsletter-band"
         role="region"
         aria-labelledby="newsletter-heading"
         data-section="newsletter"
         data-analytics-section="newsletter">
  <div class="wrap">
    <h2 id="newsletter-heading" class="section-title">Subscribe for short, useful tech & music tips</h2>
    <p>Actionable ideas and recommendations you can use — one clear note in your inbox every Friday.</p>

    {% if messages %}
      {% for m in messages %}
        {% if forloop.first %}
          <form id="newsletter_form" method="post" action="{% url 'newsletter_subscribe' %}" class="is-{{ m.tags }}" aria-busy="false">
            {% csrf_token %}
            <fieldset>
              <legend class="visually-hidden">Newsletter</legend>
              <label for="newsletter-email">Email address</label>
              <input type="email" id="newsletter-email" name="email"
                     placeholder="name@example.com"
                     aria-label="Email address for newsletter subscription"
                     required autocomplete="email" inputmode="email" spellcheck="false"
                     aria-describedby="newsletter-privacy newsletter-status">
              <input type="text" name="website" autocomplete="off" tabindex="-1" aria-hidden="true" hidden>
              <button type="submit" aria-label="Subscribe to the newsletter" class="btn btn--cta radius-md">{{ APPROVED_CTA|default:'Subscribe' }}</button>
              <div id="newsletter-status" role="status" aria-live="polite" class="form-message is-{{ m.tags }}">{{ m }}</div>
            </fieldset>
          </form>
        {% endif %}
      {% endfor %}
    {% else %}
      <form id="newsletter_form" method="post" action="{% url 'newsletter_subscribe' %}" aria-busy="false">
        {% csrf_token %}
        <fieldset>
          <legend class="visually-hidden">Newsletter</legend>
          <label for="newsletter-email">Email address</label>
          <input type="email" id="newsletter-email" name="email"
                 placeholder="name@example.com"
                 aria-label="Email address for newsletter subscription"
                 required autocomplete="email" inputmode="email" spellcheck="false"
                 aria-describedby="newsletter-privacy newsletter-status">
          <input type="text" name="website" autocomplete="off" tabindex="-1" aria-hidden="true" hidden>
          <button type="submit" aria-label="Subscribe to the newsletter" class="btn btn--cta radius-md">{{ APPROVED_CTA|default:'Subscribe' }}</button>
          <div id="newsletter-status" role="status" aria-live="polite" class="form-message"></div>
        </fieldset>
      </form>
    {% endif %}

    <p id="newsletter-privacy">We respect your inbox. Unsubscribe any time. We never sell your email.</p>
    <!--
      Messages:
        success_no_confirm: Thanks — you’re subscribed and will get the next newsletter.
        error: Something went wrong. Please try again.
        server_busy: We’re having trouble right now. Try again in a few minutes.
      Errors:
        required_email: Please enter your email address to subscribe.
        invalid_email: Enter a valid email address (example: name@example.com).
    -->
  </div>
</section>
